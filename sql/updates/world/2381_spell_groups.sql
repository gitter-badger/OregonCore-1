-- Adjust commands for new system
DELETE FROM `command` WHERE `name` = 'reload spell_group';
DELETE FROM `command` WHERE `name` = 'reload spell_group_stack_rules';
DELETE FROM `command` WHERE `name` = 'reload spell_elixir';
DELETE FROM `command` WHERE `name` = 'reload spell_stack_masks';
INSERT INTO `command` VALUES ('reload spell_group','3','Syntax: .reload spell_group\nReload spell_group table.');
INSERT INTO `command` VALUES ('reload spell_group_stack_rules','3','Syntax: .reload spell_group\nReload spell_group_stack_rules table.');

-- Drop old table
DROP TABLE IF EXISTS `spell_elixir`;

-- Create new table
CREATE TABLE `spell_group` (
  `id` int(11) unsigned NOT NULL DEFAULT 0,
  `spell_id` int(11) unsigned NOT NULL DEFAULT 0,
  PRIMARY KEY (`id`, `spell_id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 ROW_FORMAT=FIXED COMMENT='Spell System';
INSERT INTO `spell_group` (`id`, `spell_id`) VALUES
 -- SPELL_GROUP_ELIXIR_BATTLE
(1, 2367),
(1, 2374),
(1, 3160),
(1, 3164),
(1, 7844),
(1, 8212),
(1, 10667),
(1, 10669),
(1, 11328),
(1, 11334),
(1, 11390),
(1, 11405),
(1, 11406),
(1, 11474),
(1, 16322),
(1, 16323),
(1, 16329),
(1, 17038),
(1, 17537),
(1, 17538),
(1, 17539),
(1, 17624),
(1, 17626),
(1, 17627),
(1, 17628),
(1, 17629),
(1, 21920),
(1, 26276),
(1, 28486),
(1, 28488),
(1, 28490),
(1, 28491),
(1, 28493),
(1, 28497),
(1, 28501),
(1, 28503),
(1, 28518),
(1, 28519),
(1, 28520),
(1, 28521),
(1, 28540),
(1, 33720),
(1, 33721),
(1, 33726),
(1, 38954),
(1, 40567),
(1, 40568),
(1, 40572),
(1, 40573),
(1, 40575),
(1, 40576),
(1, 41608),
(1, 41609),
(1, 41610),
(1, 41611),
(1, 42735),
(1, 45373),
(1, 46837),
(1, 46839),
 -- SPELL_GROUP_ELIXIR_GUARDIAN
(2, 673),
(2, 2378),
(2, 2380),
(2, 3166),
(2, 3219),
(2, 3220),
(2, 3222),
(2, 3223),
(2, 3593),
(2, 10668),
(2, 10692),
(2, 10693),
(2, 11319),
(2, 11348),
(2, 11349),
(2, 11364),
(2, 11371),
(2, 11396),
(2, 15231),
(2, 15233),
(2, 16321),
(2, 16325),
(2, 16326),
(2, 16327),
(2, 17535),
(2, 17624),
(2, 17626),
(2, 17627),
(2, 17628),
(2, 17629),
(2, 24361),
(2, 24363),
(2, 24382),
(2, 24383),
(2, 24417),
(2, 27652),
(2, 27653),
(2, 28502),
(2, 28509),
(2, 28514),
(2, 28518),
(2, 28519),
(2, 28520),
(2, 28521),
(2, 28540),
(2, 29348),
(2, 39625),
(2, 39626),
(2, 39627),
(2, 39628),
(2, 40567),
(2, 40568),
(2, 40572),
(2, 40573),
(2, 40575),
(2, 40576),
(2, 41608),
(2, 41609),
(2, 41610),
(2, 41611),
(2, 42735),
(2, 46837),
(2, 46839),
 -- SPELL_GROUP_ELIXIR_UNSTABLE
(3, 40567),
(3, 40568),
(3, 40572),
(3, 40573),
(3, 40575),
(3, 40576),
 -- SPELL_GROUP_ELIXIR_SHATTRATH
(4, 41608),
(4, 41609),
(4, 41610),
(4, 41611),
(4, 46837),
(4, 46839),
 -- SPELL_GROUP_WELL_FED
(5, 18191),
(5, 18192),
(5, 18193),
(5, 18194),
(5, 18222),
(5, 22730),
(5, 25661);

ALTER TABLE spell_group
MODIFY spell_id INT(11) NOT NULL DEFAULT 0;
DELETE FROM spell_group WHERE id IN(5, 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 1009, 1010, 1011);
INSERT INTO spell_group (id, spell_id) VALUES
 -- Well Fed
(1001, 19705),
(1001, 19706),
(1001, 19708),
(1001, 19709),
(1001, 19710),
(1001, 19711),
(1001, 24799),
(1001, 24870),
(1001, 25694),
(1001, 25941),
(1001, 33254),
(1001, 33256),
(1001, 33257),
(1001, 33259),
(1001, 33261),
(1001, 33263),
(1001, 33265),
(1001, 33268),
(1001, 33272),
(1001, 35272),
(1001, 40323),
(1001, 42293),
(1001, 43764),
(1001, 43771),
(1001, 44097),
(1001, 44098),
(1001, 44099),
(1001, 44100),
(1001, 44101),
(1001, 44102),
(1001, 44104),
(1001, 44105),
(1001, 44106),
(1001, 45245),
(1001, 45619),
(1001, 46682),
(1001, 46687),
(1001, 46899),
(1001, 18125),
(1001, 18141),
(1001, 23697),
 -- Blessing of Might
(1002, 19740),
(1002, 25782), -- Greater
-- Battle Shout
(1003, 6673),
-- Blessing of Might, Battle Shout
(1004, -1002),
(1004, -1003),
-- Blessing of Wisdom
(1005, 19742),
(1005, 25894),
-- Blessing of Kings
(1006, 20217),
(1006, 25898), -- Greater
-- Blessing of Sanctuary
(1007, 20911),
(1007, 25899), -- Greater
-- Blessing of Protection
(1008, 1022),
(1008, 23415), -- Improved
-- Blessing of Light
(1009, 19977),
-- Blessings
(1010, -1002),
(1010, -1005),
(1010, -1006),
(1010, -1007),
(1010, -1008),
(1010, -1009),
-- Commanding shout, Battle Shout
(1011, 469),
(1011, -1003);

DROP TABLE IF EXISTS `spell_group_stack_rules`;
CREATE TABLE `spell_group_stack_rules` (
  `group_id` INT(11) UNSIGNED NOT NULL DEFAULT 0,
  `stack_rule` TINYINT(3) NOT NULL DEFAULT 0,
  PRIMARY KEY (`group_id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;
INSERT INTO spell_group_stack_rules (group_id, stack_rule) VALUES
(1, 1),
(2, 1),
(1001, 1),
(1002, 1),
(1003, 1),
(1004, 1),
(1005, 1),
(1006, 1),
(1007, 1),
(1008, 1),
(1009, 1),
(1010, 2),
(1011, 2);